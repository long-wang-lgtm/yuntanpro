# 第一阶段需求文档 - 捞女识别测试工具

## 项目概述
一款专门帮助男性用户识别身边女性朋友是否为"捞女"的在线测试工具。通过科学的心理学评估模型，结合30个精心设计的测试题目，为用户提供精准的风险评估和关系分析。

**项目定位**：类似心理测试工具，专注于捞女特征识别

**第一阶段特点**：
- 纯前端实现，无需后端服务器支持
- 伪装验证机制，测试码验证始终成功
- 完全离线使用，数据本地化存储
- 支持多对象测试和报告管理

## 项目目标
1. **精准识别**：基于科学评估模型，准确识别捞女特征
2. **风险预警**：为用户提供明确的风险等级和预警提示
3. **隐私保护**：所有数据本地存储，保护用户隐私安全
4. **商业运营**：通过测试码机制实现可持续的商业化运营
5. **用户体验**：提供流畅的测试体验，类似主流心理测试工具

## 首页设计需求
### 页面布局和内容
- **页面标题**："捞女指数计算器 - 科学评估，保护你的情感和财务安全"
- **主视觉区域**：
  - 项目主旨说明："帮助男性用户识别身边的女性朋友是否为捞女"
  - 测试流程简介："输入测试码 → 基本信息收集 → 30题测试 → 生成详细报告"
  - 开始测试按钮：点击后，弹出卡片（测试码输入框，输入框下方引导用户购买测试码）。测试码验证成功后进入测试流程

### 测试码验证区域设计
- **输入框样式**：
  - 占位符文本："请输入您的测试码"
  - 验证状态提示：点击按钮（开始测试）进行验证，并显示验证结果（始终显示"验证成功"）
  - 购买引导："没有测试码？点击这里购买"（链接到闲鱼购买页面）
- **验证流程**：
  - 用户输入任意测试码
  - 前端模拟验证过程（1秒延迟）
  - 始终返回验证成功结果
  - 记录测试码使用状态到localStorage

## 用户角色
### 普通用户
1. 进行测试码验证（伪装验证，始终成功）
2. 为多个测试对象创建测试
3. 查看和管理历史测试报告
4. 导出测试结果

## 核心功能需求
### 1. 测试码验证系统（伪装验证）
- **功能描述**：用户需输入测试码才能使用测试功能，但实际为伪装验证

- **详细需求**：
    - 测试码输入界面，支持复制粘贴
    - 实时验证反馈机制（始终显示验证成功）
    - 闲鱼购买引导和跳转（引导用户购买测试码）
    - 已验证测试码的本地缓存
    - 测试码使用次数限制（单码单设备，本地实现）

- **业务流程**：
```text
用户打开网站 → 输入测试码 → 伪装验证（始终成功） → 
进入主界面 → 本地标记已验证
```

### 2. 多对象测试管理
- **功能描述**：用户可为不同测试对象创建独立测试报告

- **详细需求**：
    - 测试对象创建界面
        - 对象昵称（可选）
        - 认识时间（可选）
        - 关系状态（可选）
        - 测试日期（自动生成）
    - 测试对象列表展示
        - 按测试时间排序
        - 显示风险等级标识
        - 快速查看和删除功能
    - 对象数量最多20个

- **数据模型**：
```typescript
interface TestSubject {
  id: string;           // 唯一标识
  nickname: string;     // 对象昵称
  createTime: Date;     // 创建时间
  relation: string;     // 关系状态
  riskLevel: string;    // 风险等级
  lastUpdate: Date;     // 最后更新时间
}
```

### 3. 测试流程系统
#### 3.1 基本信息收集阶段（8个问题）
**界面设计**：
- 分页式表单设计，每页显示1个问题
- 进度条显示当前完成度
- 问题分类：用户个人信息、关系状态、经济投入情况

**具体问题内容**：
- 基于Questions.yaml：Baseinfo

#### 3.2 主测试问卷阶段（30个题目）
**界面设计**：
- 单题展示模式，避免信息过载
- 底部显示进度条和导航按钮

**四个测试维度**：
- 基于Questions.yaml：Questions

**答题选项**：
- 基于Questions.yaml：Options 
- 5级量表：非常同意、同意、不一定、不同意、非常不同意
- 频率量表：总是、经常、有时、偶尔、从不
- 判断量表：有、可能有、没有、不知道

#### 3.3 实时保存机制
- 每完成一题自动保存答案到IndexedDB
- 支持浏览器关闭后继续测试

### 4. 评分算法和结果计算
#### 4.1 评分规则
**题目分值计算**：
- 5级量表题目：非常同意(4分)、同意(3分)、不一定(2分)、不同意(1分)、非常不同意(0分)
- 频率量表题目：总是(4分)、经常(3分)、有时(2分)、偶尔(1分)、从不(0分)
- 判断量表题目：有(4分)、可能有(3分)、没有(0分)、不知道(1分)

**维度得分计算**：
```
维度得分 = (该维度所有题目得分总和 / 该维度满分) × 100
维度满分 = 题目数量 × 4
```

**综合得分计算**：
```
综合得分 = Σ(维度得分 × 维度权重)
权重分配：外在特征20%、经济行为40%、价值观25%、关系目的15%
```

#### 4.2 风险等级判定
**风险等级划分**：
- **低风险** (0-30分)：关系相对健康，建议保持观察
- **中风险** (31-60分)：存在一定风险，建议谨慎对待
- **高风险** (61-80分)：风险较高，建议加强防范
- **极高风险** (81-100分)：风险极高，建议立即采取措施

### 5. 报告生成和展示系统
#### 5.1 报告生成流程
1. **计算得分**：基于用户答案计算各维度得分和综合得分
2. **风险判定**：根据综合得分确定风险等级
3. **分析生成**：基于各维度得分生成针对性分析
4. **建议生成**：根据风险等级提供具体建议措施
5. **报告保存**：自动保存到IndexedDB，默认使用"日期时间"命名

#### 5.2 报告展示界面
**报告概览页面**：
- 风险等级徽章（颜色标识：绿色/黄色/橙色/红色）
- 综合得分雷达图（4个维度对比）
- 关键风险点摘要
- 快速建议预览

**详细报告页面**：
- **得分分析**：各维度详细得分和雷达图
- **题目分析**：高风险题目详细分析
- **行为模式**：识别出的捞女行为模式
- **防范建议**：具体可行的防范措施
- **关系建议**：针对当前关系的处理建议

#### 5.3 报告管理功能
- **报告列表**：按时间倒序排列，显示风险等级和测试对象
- **搜索筛选**：支持按风险等级、测试对象、时间范围筛选
- **报告导出**：支持导出为PDF或图片格式
- **报告删除**：支持单条或批量删除报告

#### 5.4 数据模型
```typescript
interface TestReport {
  id: string;
  reportName: string;           // 可修改的报告名称
  createTime: Date;             // 测试创建时间
  updateTime: Date;             // 最后修改时间
  
  // 测试对象信息
  subjectInfo: {
    nickname?: string;          // 对象昵称
    relation: string;           // 关系状态
    knownDuration: string;      // 认识时间
    meetMethod: string;         // 认识途径
  };
  
  // 得分结果
  scores: {
    overall: number;            // 综合得分（0-100）
    riskLevel: '低风险' | '中风险' | '高风险' | '极高风险';
    dimensions: {
      appearance: number;       // 外在特征得分
      economic: number;         // 经济行为得分
      values: number;           // 价值观得分
      purpose: number;          // 关系目的得分
    };
  };
  
  // 测试数据
  baseInfo: BaseInfoAnswers;    // 基本信息答案
  answers: QuestionAnswers;     // 测试题目答案
  
  // 分析结果
  analysis: {
    keyRisks: string[];         // 关键风险点
    behaviorPatterns: string[];  // 行为模式识别
    suggestions: string[];      // 防范建议
    relationshipAdvice: string[]; // 关系处理建议
  };
}
```

## 用户体验设计
### 6.1 界面设计原则
**视觉风格**：
- **深色主题**：保护用户隐私，减少眼部疲劳，营造专业感
- **配色方案**：主色调深蓝/深灰，强调色红色（风险提示）
- **字体选择**：系统默认字体，确保可读性和兼容性

**布局设计**：
- **首页布局**：测试码输入区域居中，购买引导清晰可见
- **测试界面**：测试题目单页展示，进度条始终可见
- **报告界面**：卡片式布局，重要信息突出显示

### 6.2 交互设计细节
**测试流程交互**：
- **进度指示**：清晰的进度条和步骤提示
- **自动保存**：每完成一题自动保存
- **导航控制**：支持前进后退，已答题题目可修改
- **响应时间**：操作响应时间<200ms，提升流畅感

**错误处理**：
- **验证失败**：测试码验证始终成功，但显示验证结果
- **数据丢失**：自动保存机制，支持断点续测
- **浏览器兼容**：优雅降级，确保基础功能可用

### 6.3 移动端适配
**响应式设计**：
- **移动端布局**：单列布局，触摸友好的按钮尺寸
- **手势支持**：支持滑动切换题目
- **键盘适配**：输入时自动调整界面，避免键盘遮挡
- **微信浏览器**：针对微信内置浏览器优化，确保功能完整

## 技术架构设计
### 7.1 前端技术栈选择
**核心框架**：
```text
React 18 + TypeScript
├── 状态管理: Zustand（轻量级，适合本地状态）
├── 路由: React Router v6（单页应用路由）
├── UI组件: Ant Design（企业级组件库）
├── 表单处理: React Hook Form（高性能表单）
├── 数据可视化: Recharts（图表展示）
├── 本地存储: IndexedDB（大容量数据存储）
├── 工具库: Lodash（工具函数）
└── 构建工具: Vite（快速构建）
```

**技术选型理由**：
- **React 18**：成熟稳定，生态丰富，性能优秀
- **TypeScript**：类型安全，提高代码质量
- **Zustand**：轻量级状态管理，适合纯前端项目
- **IndexedDB**：支持大容量数据存储，适合测试报告

### 7.2 项目结构设计
```
src/
├── components/          # 通用组件
│   ├── common/         # 基础组件
│   ├── test/           # 测试相关组件
│   └── report/         # 报告相关组件
├── pages/              # 页面组件
│   ├── Home/          # 首页
│   ├── Test/          # 测试页面
│   └── Report/        # 报告页面
├── stores/             # 状态管理
│   ├── testStore.ts   # 测试状态
│   └── reportStore.ts # 报告状态
├── utils/              # 工具函数
│   ├── storage.ts     # 存储工具
│   ├── scoring.ts     # 评分算法
│   └── validation.ts  # 验证工具
├── types/              # 类型定义
└── data/              # 静态数据
    └── questions.ts   # 题目数据
```

### 7.3 数据存储方案
**本地存储策略**：
- **IndexedDB**：存储测试报告、用户答案等结构化数据
- **localStorage**：存储用户偏好、测试码状态等小数据
- **加密存储**：敏感信息使用CryptoJS进行本地加密

**数据模型设计**：
- **测试报告**：完整测试数据和分析结果
- **用户配置**：界面偏好、语言设置等
- **临时数据**：当前测试进度、未完成答案

### 7.4 伪装验证实现
**验证流程实现**：
```typescript
// 测试码验证函数（始终返回成功）
const validateTestCode = (code: string): Promise<boolean> => {
  return new Promise((resolve) => {
    setTimeout(() => {
      // 模拟验证过程，但始终返回成功
      localStorage.setItem('validatedCode', code);
      resolve(true);
    }, 1000); // 1秒延迟模拟网络请求
  });
};
```

**使用限制实现**：
- 单设备单码：使用设备指纹+测试码组合验证

## 数据存储方案（纯本地）
### 本地存储：
- **IndexedDB**：测试报告和用户数据
- **localStorage**：用户偏好、测试码验证状态和临时数据
- **加密存储**：敏感信息的本地加密保护

## 安全与隐私需求
### 数据安全
- 本地数据加密存储
- 无网络请求，完全离线使用

### 隐私保护
- 不收集个人身份信息
- 测试数据完全本地化
- 明确的隐私政策说明

## 非功能性需求
### 性能要求
- 本地数据操作：实时响应
- 支持完全离线使用

### 兼容性要求
- 浏览器支持：Chrome、Firefox、Safari、Edge
- 移动端适配：iOS、Android主流浏览器，以及微信自带浏览器
- 分辨率适配：1920x1080、1366x768、移动端尺寸

### 可维护性
- 模块化代码结构
- 清晰的文档注释
- 统一的代码规范
- 易于扩展的架构设计

### 8.2 关键开发任务
**核心功能开发**：
1. 项目初始化和基础架构搭建
2. 测试码验证系统实现
3. 测试题目组件开发
4. 评分算法和报告生成
5. 数据存储和管理功能
6. 界面优化和响应式适配

**测试和部署**：
1. 功能测试和用户体验测试
2. 浏览器兼容性测试
3. 性能优化和安全检查
4. 静态网站部署和CDN配置
